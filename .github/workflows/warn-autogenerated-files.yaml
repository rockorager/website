on:
  pull_request:
    types: [opened]

name: Autogenerated files check

jobs:
  warn-autogenerated:
    runs-on: namespace-profile-ghostty-sm
    timeout-minutes: 5
    permissions:
      pull-requests: write
    steps:
      - name: Check for changes
        run: |
          if gh pr view "$PR_URL" --json files | \
          jq '.files[] | select(.path=="docs/config/reference.mdx" or .path=="docs/config/keybind/reference.mdx")' --exit-status; then
            gh pr comment "$PR_URL" -b \
              "Note: This PR contains modifications to auto-generated sections of the documentation.\
              These are generated from comments in ghostty's source code. Please submit changes to \
              the upstream repository at https://github.com/ghostty-org/ghostty by modifying the appropriate\
              source files"
          fi
        env:
          PR_URL: ${{ github.event.pull_request.html_url }}
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
